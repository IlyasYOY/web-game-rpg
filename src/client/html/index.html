<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Game</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/client/js/Menu.js"></script>
    <script src="/client/js/buttons_keys.js"></script>
    <script src="/client/js/MapHandler.js"></script>
    <script src="/common/js/Map.js"></script>
    <script src="/common/js/Player.js"></script>
    <style>
        canvas {
            border: 1px solid black;
        }

        #miniMap {
            vertical-align: top;
        }
    </style>
</head>

<body>
    <div align="left">
        <canvas id="canvas"></canvas>
        <canvas id="miniMap"></canvas>
    </div>
    <script>
        // Socket.io initialization.
        let socket = io();

        let map = new Map(30);

        for (let k = 15; k < 20; ++k) {
            for (let d = 15; d < 20; ++d) {
                map.setCell(k, d, -1);
            }
        }

        for (let k = 5; k < 7; ++k) {
            for (let d = 5; d < 7; ++d) {
                map.setCell(k, d, 1);
            }
        }

        map.setCell(3, 4, 2);
        map.setCell(1, 3, 3);

        for (let k = 4; k < 7; ++k) {
            for (let d = 0; d < 3; ++d) {
                map.setCell(k, d, 4);
            }
        }

        for (let k = 2; k < 5; ++k) {
            for (let d = 13; d < 15; ++d) {
                map.setCell(k, d, -2);
            }
        }


    </script>


    <script>
        playerOne = new Player(0, 0, 0, 'magician', 10);
        playerTwo = new Player(3, 0, 0, 'warrior', 10);

        players = [playerOne, playerTwo];
    </script>

    <script type="text/javascript">

        var whereAmI = 'Menu';
        var myPlayer = 0;

        var canvasWidth = 600;
        var canvasHeight = 600;
        var miniMapWidth = canvasWidth / 3;
        var miniMapHeight = canvasHeight / 3;
        var numbersOfCell = 10;
        var sizeOfCell = canvasHeight / numbersOfCell;
        var canvas = document.getElementById('canvas');
        var canvasContext = canvas.getContext('2d');
        var miniMap = document.getElementById('miniMap');
        var miniMapContext = miniMap.getContext('2d');
        canvas.height = canvasHeight;
        canvas.width = canvasWidth;
        miniMap.height = miniMapHeight;
        miniMap.width = miniMapWidth;

        var camera = {
            startX: 0,
            startY: 0
        };

        var mauseCoord = {
            x: 0,
            y: 0,
            isDown: false
        };

        var clickedSells = {
            x: -1,
            y: -1
        };


        setInterval(function () {
            canvasContext.clearRect(0, 0, canvasWidth, canvasHeight);
            if (whereAmI === 'Menu') {
                menuHandler();
            } else if (whereAmI === 'Play') {
                toMap();
            }
        }, 100);

        canvas.onmousemove = function (event) {
            mauseCoord.x = event.pageX;
            mauseCoord.y = event.pageY;
            console.log(mauseCoord.x + ' / ' + mauseCoord.y)
        };

        canvas.onclick = function (event) {
            mauseCoord.isDown = true;
        };

        miniMap.onmousemove = function (event) {
            mauseCoord.x = event.pageX;
            mauseCoord.y = event.pageY;
            console.log(mauseCoord.x + ' / ' + mauseCoord.y)
        };

        miniMap.onclick = function (event) {
            mauseCoord.isDown = true;
        };

        window.onkeyup = function (event) {
            setKeyUp(event.keyCode);
        };

        window.onkeydown = function (event) {
            setKeyPush(event.keyCode);
        };


    </script>
</body>

</html>